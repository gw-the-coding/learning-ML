# intro

딥러닝에 대해서 공부해보기 전에
데이터를 가장 쉽게 분석할 수 있는 방법부터 생각해볼 필요가 있음

선형 회귀 (linear regression) 라고 하는 방법
네이버에는 
https://terms.naver.com/entry.nhn?docId=827565&cid=42344&categoryId=42344
이렇게 다루고 있지만...
도저히 어떤 내용인지 알아먹기가 어렵다.

딥러닝에 대해서 다루기 전에 먼저 선형회귀부터 이해하고 시작하게 되면
우리가 왜 이것을 배워야 하는지 알 수 있을 것 같아서.. 먼저 시작해봄

# example1

만약 학생들의 '중간고사 성적'과 각 학생이 '공부한 시간'에 대한 데이터가 있다고 생각해보자

|공부한시간|2시간|4시간|6시간|8시간|
|------|---|---|---|---|
|성적|81점|93점|91점|97점|

공부한 시간을 X라고 하고, 성적을 y라고 할 때
X와 y에 대한 집합을 아래와 같이 표현해볼 수 있다.
$$
x = \{2,4,6,8\}
$$

$$
y = \{81,93,91,97\}
$$

![graph1](./image/0-1graph.png)


그래프로 그려보면 이렇다. (그리기 참 어렵다. https://www.desmos.com/calculator)

만약에 위 데이터를 분석해보면서
100점을 맞을려면 몇시간을 공부해야 하는지 추론해보려면 어떻게 해야할까?

위 점들에 대한 추세가 잘 나타나도록 직선 그래프를 하나 딱! 그리고 y가 100일 때 x를 구하면 되지 않을까?

여기서 그 직선 그래프는 아래와 같이 표현될 수 있는데
$$
y= ax+b
$$
우리가 수학시간에 배웠던 1차함수 그래프!!
a는 기울기!! b는 y절편!! 으로 배웠을 것이다.

자 이제 그릴 준비는 다 되었는데..
어떻게 그려야 잘그렸다고 소문이 날까?



이 직선을 잘 그으려면 2가지 값만 잘 예측하면 된다.
a,b

딥러닝의 시작점은 이 a,b 값을 잘 예측하는 것으로 부터 시작된다고 봐도 과언이 아니다.

이제 선을 잘 긋는 방법부터 살펴보자



# 최소 제곱법

[https://ko.wikipedia.org/wiki/%EC%B5%9C%EC%86%8C%EC%A0%9C%EA%B3%B1%EB%B2%95](https://ko.wikipedia.org/wiki/최소제곱법)

먼저 시도해 볼 수 있는 방법은 최소 제곱법이라는 방법이다.

그래프와 각 점들과의 거리를 계산하여 가장 작게 나오도록 구한다. 라는 원칙을 기준으로
$$
\sum_{i=1}^n(각 점들과 그래프와의 차이)^2
$$
요런 식을 만들고, 
고등학교 때 배운 '페르마의 정리'에 의해 
위 식의 미분값이 0이 나오게 되면
그때의 a,b값이 가장 정확한 그래프가 아닐까?
$$
\sum_{i=1}^{n}(y_i - (ax_i+b))^2
$$
요 식이 최소가 된다고 한다면

a,b에 대한 각각의 편미분을 아래와 같이 해볼 수 있을 것이고
$$
\frac\part {\part{a}}\sum_{i=1}^{n}(y_i - ax_i -b)^2 =0
$$

$$
\frac\part {\part{b}}\sum_{i=1}^{n}(y_i - ax_i -b)^2 = 0
$$

이렇게 두가지 수식으로 나눠볼 수 있다.

편미분 지금 풀려면 어려우니까 다풀고 난 수식만 적어보자면

최종적으로
$$
a\sum_{i=1}^{n}x_i^2 + b\sum_{i=1}^{n}x_i = \sum_{i=1}^{n}x_iy_i
$$

$$
a\sum_{i=1}^{n}x_i + b\sum_{i=1}^{n}1 = \sum_{i=1}^{n}y_i
$$

위의 두 식이 남게 된다.

그럼 한번 대입해서 계산해볼까? 개수가 4개니 n은 4이고...
$$
(2^2+4^2+6^2+8^2)a+(2+4+6+8)b = (2*81 + 4*93 + 6*91 + 8*97)
$$

$$
(2+4+6+8)*a + (1+1+1+1)b = (81+93+91+97)
$$

위 연립방정식을 풀게되면
$$
a = 2.3, b=79
$$
가 나오게 되어 아래의 직선의 방정식을 구하게 된다.
$$
y=2.3x+79
$$
한번 그래프를 그려볼까?
![graph1](./image/0-2graph.png)

대충 잘 맞아 들어가는 것을 볼 수 있다. 헤헷



하지만!! 여러개의 입력값(x가 여러개...)이 있는 경우에는 이 공식만으로 처리할 수 없다 ㅠ

그래서 평균 제곱근 오차(root mean square error, RMSE)가 쓰이게 된다!!



# 평균 제곱근 오차

